
<script >
  // Remove the duplicate markerjs
function removeDuplicates(){
              try{
                    let toolbar = document.querySelector('.markerjs-toolbar');
                    toolbar.parentNode.removeChild(toolbar);
                    let display = document.querySelector('.image-anotator-area')
                    display.parentNode.removeChild(display)
                    let logo = document.querySelector('.markerjs-logo')
                    logo.parentNode.removeChild(logo)
                  }
                  catch(e)
                  {/* Do nothing*/}
}
function disableScroll() { 
                  // Get the current page scroll position 
                  scrollTop = window.pageYOffset || document.documentElement.scrollTop; 
                  scrollLeft = window.pageXOffset || document.documentElement.scrollLeft, 
            
                  // if any scroll is attempted, set this to the previous value 
                  window.onscroll = function() { 
                      $(".markerjs-toolbar").effect( "shake", {times:1}, 100 );
                        console.log("attempted to scroll")
                        window.scrollTo(scrollLeft, scrollTop); 
                      }; 
                      
} 
function enableScroll() { 
              window.onscroll = function() {}; 
} 



$(window).on('load', function() {
              $('#reply-control').css('height','70%');  
});

//Exec when image is clicked
$('body').on('click', '.d-editor-preview img', function() {

//Center image when clicked
this.scrollIntoView({
        behavior: 'auto',
        block: 'center',
        inline: 'center'
    });

removeDuplicates();
let theMarker =  showMarkerJs(this);

      // Watch for height changes 
      $('#reply-control').resize(function()
      {
              try{
                      console.log('Height changed!!!');
                      theMarker.mark.close();
                      theMarker = showMarkerJs(theMarker.img,theMarker.previousState)
                      $('#svg-sprites').next().addClass('image-anotator-area');
              }
              catch(e)
              {/*Do nothing*/}
      })

      //Enable scroll if toolbar is closed
      function reenableScroll(){
        console.log("Tracking toolbar.")
        if(!$('.markerjs-toolbar').is(':visible')){
                      enableScroll();
                      $(".d-editor-preview-wrapper ").css("overflow","auto");
                      clearInterval(timer) 
                  }
      }
      let timer = setInterval(reenableScroll,700);

$(document).ready(function () {
      $('#svg-sprites').next().addClass('image-anotator-area');
      $('.d-editor-preview img').addClass('resizable'); 
      $(".resizable").attr("crossorigin","anonymous");
      $('#reply-control').css('height','70%');
  }); 
})    
</script>